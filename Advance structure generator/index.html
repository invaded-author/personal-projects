<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Structure Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #000000 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            background: rgb(0, 0, 0);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }
        
        h1 {
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 2em;
        }
        
        .subtitle {
            color: #ffffff;
            margin-bottom: 30px;
            font-size: 0.95em;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }
        
        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .input-section {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            color: #ffffff;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95em;
        }
        
        textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .directory-tree {
            background: #ffffff;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .directory-tree-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .directory-tree h3 {
            color: #333;
            font-size: 1.1em;
            margin: 0;
        }
        
        .help-note {
            background: #f3f2ef;
            color: #ac8100;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8em;
            border: 1px solid #ffc400;
            display: flex;
            align-items: center;
            gap: 6px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.4);
            }
            70% {
                box-shadow: 0 0 0 6px rgba(255, 193, 7, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 193, 7, 0);
            }
        }
        
        .tree-item {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tree-item:hover {
            background: #e9ecef;
        }
        
        .tree-item.selected {
            background: #667eea;
            color: white;
        }
        
        .tree-item.file {
            color: #666;
        }
        
        .tree-icon {
            font-size: 16px;
        }
        
        .file-editor {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            display: none;
        }
        
        .file-editor.active {
            display: block;
        }
        
        .file-editor h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .selected-path {
            background: #e9ecef;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #555;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        
        .file-type-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .file-type-select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .content-editor {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            resize: vertical;
        }
        
        .content-editor:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f0f0f0;
            color: #555;
        }
        
        .btn-secondary:hover {
            background: #e0e0e0;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        .files-list {
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #e9ecef;
        }
        
        .files-list h4 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1em;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-path {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #667eea;
            font-weight: 600;
        }
        
        .file-meta {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .icon {
            width: 16px;
            height: 16px;
        }
        
        .empty-state {
            text-align: center;
            color: #999;
            padding: 20px;
            font-size: 14px;
        }
        
        .tree-section {
            margin-bottom: 15px;
        }
        
        .tree-section-title {
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 0.9em;
            padding-left: 10px;
            border-left: 3px solid #667eea;
        }
        
        .cmd-command-section {
            margin-top: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }
        
        .cmd-command-section h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .cmd-command-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
            overflow-x: auto;
            white-space: pre-wrap;
            word-break: break-all;
            margin-bottom: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .copy-btn {
            background: #4a5568;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .copy-btn:hover {
            background: #2d3748;
        }
        
        .copy-btn.copied {
            background: #38a169;
        }
        
        .cmd-info {
            font-size: 12px;
            color: #666;
            margin-top: 10px;
            font-style: italic;
        }
        
        /* File Notification Styles */
        .file-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            animation: slideInRight 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
            max-width: 350px;
        }
        
        .file-notification.error {
            background: #dc3545;
        }
        
        .file-notification.info {
            background: #17a2b8;
        }
        
        .file-notification.warning {
            background: #ffc107;
            color: #212529;
        }
        
        .notification-icon {
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 2px;
        }
        
        .notification-message {
            font-size: 12px;
            opacity: 0.9;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
        
        .notification-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background: rgba(255,255,255,0.5);
            width: 100%;
            border-radius: 0 0 8px 8px;
            overflow: hidden;
        }
        
        .notification-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: white;
            animation: progressBar 3s linear forwards;
        }
        
        @keyframes progressBar {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Advanced Project Structure Generator</h1>
        <p class="subtitle">Create project structure with files containing custom content</p>
        
        <div class="main-grid">
            <div class="input-section">
                <label for="structure">Project Structure:</label>
                <textarea id="structure" placeholder="project/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ biometrics/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ desktop-app/
‚îú‚îÄ‚îÄ mobile-app/
‚îî‚îÄ‚îÄ shared/">project/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ biometrics/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ security/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ desktop-app/
‚îú‚îÄ‚îÄ mobile-app/
‚îî‚îÄ‚îÄ shared/</textarea>
                <button class="btn-secondary" onclick="updateTree()" style="margin-top: 10px; width: 100%;">
                    Update Directory Tree
                </button>
            </div>
            
            <div>
                <div class="directory-tree">
                    <div class="directory-tree-header">
                        <h3>Project Structure</h3>
                        <div class="help-note">
                            <span>üí°</span>
                            Click on any folder to add files and content
                        </div>
                    </div>
                    <div id="treeView">
                        <div class="empty-state">Click "Update Directory Tree" to see directories</div>
                    </div>
                </div>
                
                <div class="file-editor" id="fileEditor">
                    <h3>Add File with Content</h3>
                    <div class="selected-path" id="selectedPath"></div>
                    
                    <div class="form-group">
                        <label for="fileName">File Name (with extension):</label>
                        <input type="text" id="fileName" placeholder="e.g., index.js, config.json, README.md">
                    </div>
                    
                    <div class="form-group">
                        <label for="fileContent">File Content:</label>
                        <textarea class="content-editor" id="fileContent" placeholder="Enter the content for this file..."></textarea>
                    </div>
                    
                    <button class="btn-success" onclick="addFile()" style="width: 100%;">
                        Add File to Project
                    </button>
                </div>
            </div>
        </div>
        
        <div class="files-list" id="filesList" style="display: none;">
            <h4>Files with Content</h4>
            <div id="filesContainer"></div>
        </div>
        
        <div class="cmd-command-section">
            <h3>CMD Command</h3>
            <div class="cmd-command-box" id="cmdCommand">
                @echo off
                echo Creating project structure...
                
                REM Generated on <span id="generationDate"></span>
                
                REM Add your directory and file creation commands here
            </div>
            <button class="copy-btn" id="copyCmdBtn" onclick="copyCmdCommand()">
                Copy CMD Command
            </button>
            <div class="cmd-info">
                This command will be automatically updated when you add/remove files or directories
            </div>
        </div>
        
        <div class="button-group">
            <button class="btn-warning" onclick="downloadZip()">
                Download as ZIP
            </button>
            <button class="btn-secondary" onclick="clearAll()">
                üóëÔ∏è Clear All
            </button>
        </div>
        
        <div class="success-message" id="successMessage"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        let selectedDirectory = '';
        let filesWithContent = [];
        let projectStructure = [];
        
        // Function to remove trailing slashes from a path
        function removeTrailingSlash(path) {
            return path.replace(/\/+$/, '');
        }
        
        function parseStructure(text) {
            const lines = text.trim().split('\n');
            const paths = [];
            const stack = [{path: '', level: -1}];
            
            for (let line of lines) {
                const cleaned = line.replace(/[‚îÇ‚îú‚îî‚îÄ]/g, '').trim();
                if (!cleaned) continue;
                
                const level = (line.match(/‚îÇ/g) || []).length + (line.match(/[‚îú‚îî]/g) || []).length;
                const name = cleaned.replace(/^[‚îú‚îî‚îÄ‚îÇ\s]+/, '').trim();
                
                while (stack.length > 0 && stack[stack.length - 1].level >= level) {
                    stack.pop();
                }
                
                const parent = stack[stack.length - 1];
                let fullPath = parent.path ? `${parent.path}/${name}` : name;
                
                // Remove trailing slashes from directory paths
                if (name.endsWith('/')) {
                    fullPath = removeTrailingSlash(fullPath);
                }
                
                paths.push({
                    path: fullPath,
                    isFile: !name.endsWith('/'),
                    name: name
                });
                
                if (name.endsWith('/')) {
                    stack.push({path: fullPath, level: level});
                }
            }
            
            return paths;
        }
        
        function updateTree() {
            const structure = document.getElementById('structure').value;
            if (!structure.trim()) {
                showFileNotification('error', 'Missing Structure', 'Please enter a project structure first');
                return;
            }
            
            projectStructure = parseStructure(structure);
            renderTree();
            updateCmdCommand(); // Update CMD command when tree changes
            
            showFileNotification('success', 'Directory Tree Updated', 'Project structure has been updated successfully');
        }
        
        function renderTree() {
            const treeView = document.getElementById('treeView');
            treeView.innerHTML = '';
            
            if (projectStructure.length === 0 && filesWithContent.length === 0) {
                treeView.innerHTML = '<div class="empty-state">Click "Update Directory Tree" to see directories</div>';
                return;
            }
            
            // Create a map to organize items by directory
            const directoryMap = {};
            
            // Add directories from the project structure
            projectStructure.forEach(item => {
                if (!item.isFile) {
                    const dirPath = item.path;
                    if (!directoryMap[dirPath]) {
                        directoryMap[dirPath] = {
                            path: dirPath,
                            name: item.name,
                            files: []
                        };
                    }
                }
            });
            
            // Add files from the project structure
            projectStructure.forEach(item => {
                if (item.isFile) {
                    const dirPath = item.path.substring(0, item.path.lastIndexOf('/'));
                    if (directoryMap[dirPath]) {
                        directoryMap[dirPath].files.push({
                            path: item.path,
                            name: item.name
                        });
                    }
                }
            });
            
            // Add files with custom content
            filesWithContent.forEach(file => {
                const dirPath = file.path.substring(0, file.path.lastIndexOf('/'));
                const fileName = file.path.substring(file.path.lastIndexOf('/') + 1);
                
                if (!directoryMap[dirPath]) {
                    directoryMap[dirPath] = {
                        path: dirPath,
                        name: dirPath.substring(dirPath.lastIndexOf('/') + 1),
                        files: []
                    };
                }
                
                // Check if file already exists in this directory
                const existingFile = directoryMap[dirPath].files.find(f => f.path === file.path);
                if (!existingFile) {
                    directoryMap[dirPath].files.push({
                        path: file.path,
                        name: fileName,
                        hasContent: true
                    });
                } else {
                    existingFile.hasContent = true;
                }
            });
            
            // Sort directories by path
            const sortedDirectories = Object.values(directoryMap).sort((a, b) => a.path.localeCompare(b.path));
            
            // Render directories and their files
            sortedDirectories.forEach(dir => {
                const dirSection = document.createElement('div');
                dirSection.className = 'tree-section';
                
                const dirHeader = document.createElement('div');
                dirHeader.className = 'tree-section-title';
                dirHeader.innerHTML = `<span class="tree-icon">üìÅ</span> ${dir.path}`;
                
                // Make directory clickable
                dirHeader.style.cursor = 'pointer';
                dirHeader.onclick = () => selectDirectory(dir.path, dirHeader);
                
                dirSection.appendChild(dirHeader);
                
                // Add files in this directory
                if (dir.files.length > 0) {
                    const fileList = document.createElement('div');
                    fileList.style.marginLeft = '20px';
                    
                    dir.files.forEach(file => {
                        const fileItem = document.createElement('div');
                        fileItem.className = 'tree-item file';
                        
                        // Different icon for files with custom content
                        const fileIcon = file.hasContent ? 'üìù' : 'üìÑ';
                        
                        fileItem.innerHTML = `<span class="tree-icon">${fileIcon}</span> ${file.name}`;
                        fileItem.onclick = (e) => {
                            e.stopPropagation();
                            selectFile(file.path, fileItem);
                        };
                        
                        fileList.appendChild(fileItem);
                    });
                    
                    dirSection.appendChild(fileList);
                }
                
                treeView.appendChild(dirSection);
            });
            
            // Add files that don't belong to any directory (root level files)
            const rootFiles = filesWithContent.filter(file => !file.path.includes('/'));
            if (rootFiles.length > 0) {
                const rootSection = document.createElement('div');
                rootSection.className = 'tree-section';
                
                const rootHeader = document.createElement('div');
                rootHeader.className = 'tree-section-title';
                rootHeader.innerHTML = `<span class="tree-icon">üìÅ</span> Root`;
                rootSection.appendChild(rootHeader);
                
                const fileList = document.createElement('div');
                fileList.style.marginLeft = '20px';
                
                rootFiles.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'tree-item file';
                    fileItem.innerHTML = `<span class="tree-icon">üìù</span> ${file.path}`;
                    fileItem.onclick = (e) => {
                        e.stopPropagation();
                        selectFile(file.path, fileItem);
                    };
                    fileList.appendChild(fileItem);
                });
                
                rootSection.appendChild(fileList);
                treeView.appendChild(rootSection);
            }
        }
        
        function selectDirectory(path, element) {
            document.querySelectorAll('.tree-section-title').forEach(item => {
                item.style.background = 'transparent';
                item.style.color = '#555';
            });
            
            element.style.background = '#667eea';
            element.style.color = 'white';
            element.style.borderRadius = '6px';
            element.style.padding = '8px 12px';
            
            selectedDirectory = removeTrailingSlash(path);
            document.getElementById('selectedPath').textContent = `Path: ${selectedDirectory}/`;
            document.getElementById('fileEditor').classList.add('active');
            document.getElementById('fileName').focus();
            
            showFileNotification('info', 'Directory Selected', `Ready to add files to ${selectedDirectory}`);
        }
        
        function selectFile(path, element) {
            document.querySelectorAll('.tree-item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // Find the file in our filesWithContent array
            const file = filesWithContent.find(f => f.path === path);
            if (file) {
                document.getElementById('selectedPath').textContent = `üìç Editing: ${path}`;
                document.getElementById('fileName').value = path.substring(path.lastIndexOf('/') + 1);
                document.getElementById('fileContent').value = file.content;
                document.getElementById('fileEditor').classList.add('active');
                
                // Set selected directory to the file's parent directory
                const dirPath = path.substring(0, path.lastIndexOf('/'));
                selectedDirectory = removeTrailingSlash(dirPath);
                
                showFileNotification('info', 'File Selected', `Editing ${path.substring(path.lastIndexOf('/') + 1)}`);
            }
        }
        
        function addFile() {
            if (!selectedDirectory) {
                showFileNotification('error', 'No Directory Selected', 'Please select a directory first');
                return;
            }
            
            const fileName = document.getElementById('fileName').value.trim();
            const fileContent = document.getElementById('fileContent').value;
            
            if (!fileName) {
                showFileNotification('error', 'Missing File Name', 'Please enter a file name');
                return;
            }
            
            // Ensure we don't have double slashes in the path
            const cleanDirectory = removeTrailingSlash(selectedDirectory);
            const fullPath = cleanDirectory ? `${cleanDirectory}/${fileName}` : fileName;
            
            const existingIndex = filesWithContent.findIndex(f => f.path === fullPath);
            if (existingIndex !== -1) {
                if (!confirm('This file already exists. Do you want to overwrite it?')) {
                    return;
                }
                filesWithContent.splice(existingIndex, 1);
            }
            
            filesWithContent.push({
                path: fullPath,
                content: fileContent
            });
            
            updateFilesList();
            renderTree(); // Update the tree to show the new file
            updateCmdCommand(); // Update CMD command when files change
            
            // Show file addition notification
            const locationName = cleanDirectory || 'Root';
            showFileNotification('success', 'File Added to Project', `${fileName} has been added to ${locationName}`);
            
            document.getElementById('fileName').value = '';
            document.getElementById('fileContent').value = '';
        }
        
        function showFileNotification(type, title, message) {
            // Remove any existing notifications
            const existingNotifications = document.querySelectorAll('.file-notification');
            existingNotifications.forEach(notification => {
                notification.remove();
            });
            
            // Create new notification
            const notification = document.createElement('div');
            notification.className = `file-notification ${type}`;
            
            const icons = {
                success: '‚úÖ',
                error: '‚ùå',
                info: '‚ÑπÔ∏è',
                warning: '‚ö†Ô∏è'
            };
            
            notification.innerHTML = `
                <div class="notification-icon">${icons[type] || 'üìÑ'}</div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <div class="notification-progress"></div>
            `;
            
            document.body.appendChild(notification);
            
            // Remove notification after animation completes
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }
        
        function updateFilesList() {
            const container = document.getElementById('filesContainer');
            const filesList = document.getElementById('filesList');
            
            if (filesWithContent.length === 0) {
                filesList.style.display = 'none';
                return;
            }
            
            filesList.style.display = 'block';
            container.innerHTML = '';
            
            filesWithContent.forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'file-item';
                
                const hasContent = file.content && file.content.trim().length > 0;
                const contentPreview = hasContent ? 
                    `${file.content.substring(0, 50)}${file.content.length > 50 ? '...' : ''}` : 
                    'Empty file';
                
                item.innerHTML = `
                    <div class="file-info">
                        <div class="file-path">${file.path}</div>
                        <div class="file-meta">
                            Content: ${file.content.length} chars | 
                            ${contentPreview}
                        </div>
                    </div>
                    <button class="btn-danger btn-small" onclick="removeFile(${index})">
                        ‚úï Remove
                    </button>
                `;
                
                container.appendChild(item);
            });
        }
        
        function removeFile(index) {
            const removedFile = filesWithContent[index];
            filesWithContent.splice(index, 1);
            updateFilesList();
            renderTree(); // Update the tree to remove the file
            updateCmdCommand(); // Update CMD command when files change
            
            // Show removal notification
            const fileName = removedFile.path.substring(removedFile.path.lastIndexOf('/') + 1);
            const locationName = removedFile.path.substring(0, removedFile.path.lastIndexOf('/')) || 'Root';
            showFileNotification('info', 'File Removed', `${fileName} has been removed from ${locationName}`);
        }
        
        function updateCmdCommand() {
            const structure = document.getElementById('structure').value;
            if (!structure.trim()) {
                document.getElementById('cmdCommand').textContent = '@echo off\necho Please enter a project structure first';
                return;
            }
            
            const paths = parseStructure(structure);
            let cmdCommand = '@echo off\n';
            cmdCommand += 'echo Creating project structure...\n\n';
            cmdCommand += 'REM Project Structure Generator with Content\n';
            cmdCommand += 'REM Generated on ' + new Date().toLocaleString() + '\n\n';
            
            // Create directories first
            for (let item of paths) {
                if (!item.isFile) {
                    const winPath = item.path.replace(/\//g, '\\');
                    cmdCommand += `if not exist "${winPath}" mkdir "${winPath}"\n`;
                }
            }
            
            // Create files
            for (let item of paths) {
                if (item.isFile) {
                    const winPath = item.path.replace(/\//g, '\\');
                    const fileWithContent = filesWithContent.find(f => f.path === item.path);
                    
                    if (fileWithContent && fileWithContent.content) {
                        cmdCommand += `(\n`;
                        fileWithContent.content.split('\n').forEach(line => {
                            if (line.trim() === '') {
                                cmdCommand += `echo.\n`;
                            } else {
                                cmdCommand += `echo ${line.replace(/"/g, '""')}\n`;
                            }
                        });
                        cmdCommand += `) > "${winPath}"\n`;
                    } else {
                        cmdCommand += `type nul > "${winPath}"\n`;
                    }
                }
            }
            
            // Add files with custom content that aren't in the original structure
            for (let file of filesWithContent) {
                if (!paths.find(p => p.path === file.path)) {
                    const winPath = file.path.replace(/\//g, '\\');
                    const dir = winPath.substring(0, winPath.lastIndexOf('\\'));
                    
                    if (dir) {
                        cmdCommand += `if not exist "${dir}" mkdir "${dir}"\n`;
                    }
                    
                    cmdCommand += `(\n`;
                    file.content.split('\n').forEach(line => {
                        if (line.trim() === '') {
                            cmdCommand += `echo.\n`;
                        } else {
                            cmdCommand += `echo ${line.replace(/"/g, '""')}\n`;
                        }
                    });
                    cmdCommand += `) > "${winPath}"\n`;
                }
            }
            
            cmdCommand += '\necho Project structure created successfully!\n';
            cmdCommand += `echo Created ${paths.length} items with ${filesWithContent.length} files containing content\n`;
            cmdCommand += 'pause\n';
            
            document.getElementById('cmdCommand').textContent = cmdCommand;
            document.getElementById('generationDate').textContent = new Date().toLocaleString();
        }
        
        function copyCmdCommand() {
            const cmdCommand = document.getElementById('cmdCommand').textContent;
            
            // Create a temporary textarea element to copy from
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = cmdCommand;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            tempTextArea.setSelectionRange(0, 99999); // For mobile devices
            
            try {
                const successful = document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                
                if (successful) {
                    const copyBtn = document.getElementById('copyCmdBtn');
                    const originalText = copyBtn.innerHTML;
                    copyBtn.innerHTML = '‚úÖ Copied!';
                    copyBtn.classList.add('copied');
                    
                    setTimeout(() => {
                        copyBtn.innerHTML = originalText;
                        copyBtn.classList.remove('copied');
                    }, 2000);
                    
                    showFileNotification('success', 'CMD Command Copied', 'Command has been copied to clipboard');
                } else {
                    showFileNotification('error', 'Copy Failed', 'Failed to copy command to clipboard');
                }
            } catch (err) {
                document.body.removeChild(tempTextArea);
                console.error('Failed to copy: ', err);
                showFileNotification('error', 'Copy Error', 'Failed to copy command to clipboard');
            }
        }
        
        function downloadZip() {
            const structure = document.getElementById('structure').value;
            if (!structure.trim() && filesWithContent.length === 0) {
                showFileNotification('error', 'No Content', 'Please enter a project structure or add some files first');
                return;
            }
            
            const zip = new JSZip();
            const paths = parseStructure(structure);
            
            // Add directories
            paths.forEach(item => {
                if (!item.isFile) {
                    // Directories are created implicitly when adding files
                }
            });
            
            // Add files from structure
            paths.forEach(item => {
                if (item.isFile) {
                    const fileWithContent = filesWithContent.find(f => f.path === item.path);
                    const content = fileWithContent ? fileWithContent.content : '';
                    zip.file(item.path, content);
                }
            });
            
            // Add files with custom content that aren't in the structure
            filesWithContent.forEach(file => {
                if (!paths.find(p => p.path === file.path)) {
                    zip.file(file.path, file.content);
                }
            });
            
            // Generate ZIP file
            zip.generateAsync({type: "blob"})
                .then(function(content) {
                    const projectName = getProjectName() || 'project-structure';
                    saveAs(content, `${projectName}.zip`);
                    showFileNotification('success', 'ZIP Downloaded', `Project structure saved as ${projectName}.zip`);
                })
                .catch(function(error) {
                    console.error('Error generating ZIP:', error);
                    showFileNotification('error', 'ZIP Error', 'Failed to generate ZIP file');
                });
        }
        
        function getProjectName() {
            const structure = document.getElementById('structure').value;
            const firstLine = structure.trim().split('\n')[0];
            if (firstLine && firstLine.endsWith('/')) {
                return firstLine.replace(/\/$/, '');
            }
            return null;
        }
        
        function clearAll() {
            if (confirm('Are you sure you want to clear all files and structure? This cannot be undone.')) {
                filesWithContent = [];
                document.getElementById('structure').value = '';
                document.getElementById('fileName').value = '';
                document.getElementById('fileContent').value = '';
                document.getElementById('fileEditor').classList.remove('active');
                updateFilesList();
                renderTree();
                updateCmdCommand();
                showFileNotification('info', 'All Cleared', 'All files and structure have been cleared');
            }
        }
        
        function showSuccess(message) {
            const successEl = document.getElementById('successMessage');
            successEl.textContent = '‚úì ' + message;
            successEl.style.display = 'block';
            setTimeout(() => {
                successEl.style.display = 'none';
            }, 5000);
        }
        
        // Initialize the tree and CMD command on page load
        updateTree();
    </script>
</body>
</html>